Network Mapping Techniques

Network mapping can involve a variety of techniques for probing hosts and ports. Several common techniques are listed below:

■■ ICMP echo requests (ping): If you ping a host and it replies, it is alive (i.e., up and running). This test does not show what individual services are running. Be aware that many networks block incoming echo requests. If the requests are blocked and you ping a host and it does not reply, you have no way of knowing if it is actually running or not because the request is blocked before it gets to the destination.

■■ TCP Connect scan: A connect scan can be used to discover TCP services running on a host even if ICMP is blocked. This type of scan is considered “noisy” (noticeable to logging and intrusion detection systems) because it goes all the way through the connection process. This basic service discovery scan goes all the way through a TCP session setup by sending a SYN packet to a target, receiving the SYN/ACK from the target when the port is listening, then sending a final ACK back to the target to establish the connection. At this point, the test host is “connected” to the target. Eventually, the connection is torn down because the tester’s goal is not to communicate with the port, but only to discover whether it is available.

■■ TCP SYN scan: SYN scanning can be used to discover TCP services running on a host even if ICMP is blocked. SYN scanning is considered less noisy than connect scans. It is referred to as “half-open” scanning because unlike a connect scan (above), you do not open a full TCP connection. Your test host directs a TCP SYN packet on a particular port as if it were going to open a real TCP connection to the target host. A SYN/ACK from the target indicates the host is listening on that port. An RST from the target indicates that it is not listening on that port. If a SYN/ ACK is received, the test host immediately sends an RST to tear down the connection to conserve resources on both the test and target host sides. Firewalls often detect and block these scan attempts.

■■ TCP FIN scan: FIN scanning can be used to discover TCP services running on a host even if ICMP is blocked. FIN scanning is considered a stealthy way to discover if a service is running. The test host sends a TCP packet with the FIN bit on to a port on the target host. If the target responds with an RST packet, you may assume that the target host is not using the port. If the host does not respond, it may be using the port that was probed. Caveats to this technique are Microsoft, Cisco, BSDI, HP/ UX, MVS, and IRIX-based hosts that implement their TCP/IP software stacks in ways not defined by the standard. These hosts may not respond with an RST when probed by a FIN. However, if you follow up a nonreply to one of these systems with, for example, a SYN scan to that port and the host replies, you have determined that the host is listening on the port being tested and a few possible operating systems (see OS fingerprinting).

■■ TCP XMAS scan: XMAS scans are similar to a FIN scan (and similarly stealthy), but they additionally turn on the URG (urgent) and PSH (push) flags. The goal of this scan is the same as a TCP FIN scan. The additional flags might make a packet be handled differently than a standard packet, so you might see different results.

■■ TCP NULL scan: NULL scans are similar to a FIN scan (also stealthy), but they turn off all flags. The NULL scan is similar to the others noted above; however, by turning off all TCP flags (which should never occur naturally), the packet might be handled differently and you may see a different result.

■■ UDP scans: A UDP scan determines which UDP service ports are opened on a host. The test machine sends a UDP packet on a port to the target. If the target sends back an ICMP port unreachable message, the target does not use that port. A potential problem with this methodology is the case where a router or firewall at the target network does not allow ICMP port unreachable messages to leave the network, making the target network appear as if all UDP ports are open (because no ICMP messages are getting back to the test host). Another problem is that many systems limit the number of ICMP messages allowed per second, which can make for a very slow scanning rate.