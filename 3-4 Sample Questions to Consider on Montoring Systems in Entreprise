Sample Questions to Consider

■■ Will the host configuration change require a reconfiguration of the HIDS component?

■■ Will the addition of a database application of a host require the HIDS agent to be configured to screen database transactions for validity?

■■ Will the network change require alterations to the way the NIDS collects data?

■■ Will the new services offered on a host require the NIDS to be tuned to have the appropriate active or passive responses to exploits that target those new services?

■■ Will the DMZ to management network firewall rules need to be changed to accommodate the logging stream from the new web server placed on the DMZ?
Collecting Data for Incident Response

Organizations must have a policy and plan for dealing with events as they occur and the corresponding forensics of incidents. Consider the following questions:

■■ How does the organization plan to collect event and forensic information from the IDS/IPS? Organizations cannot expect IDS/IPS to be a “set it and forget it” technology. Human interaction is required to interpret events and high-level responses. IDS can organize events by priority and can even be set to react in a certain way to an observed event, but humans will periodically need to decide if the IDS is doing its job properly.

■■ How will the organization have the IDS/IPS respond to events? Depending on the IDS/IPS capabilities, the organization will need to decide how it wants the IPS to react to an observed event. The next section discusses active versus passive IDS response.

■■ How will the organization respond to incidents? What investigative actions will the security staff take based on singular or repeated incidents involving one or more observed events? This is a function of your security policy.

When organizations suffer attacks, logging information, whether generated by a host, network device, IDS/IPS, or other device, may be at some point considered evidence by law enforcement personnel. Preserving a chain of custody for law enforcement is important so as not to taint the evidence for use in criminal proceedings.
Monitoring Response Techniques

If unauthorized activity is detected, IDS/IPS systems can take one or both of the following actions:

■■ Passive response: Notes the event at various levels but does not take any type of evasive action. The response is by definition passive because the event is merely noted.

■■ Active response: Notes the event and performs a reaction to protect systems from further exploitation.

The following are examples of passive IDS/IPS response:

■■ Logging the event to a log file

■■ Displaying an alert on the console of an event viewer or security information management system

■■ Logging the details of a packet flow that was identified to be associated with an unauthorized event for a specified period of time, for the purpose of subsequent forensic analysis

■■ Sending an alert page, text message, or e-mail to an administrator

The following are examples of active IPS response:

■■ In the case of an unauthorized TCP data flow on a network, initiate a NIDS reset the connection (with a TCP reset) between an attacker and the host being attacked. This only works with TCP-based attacks because they are connection oriented.

■■ In the case of any IP data flow (TCP, UDP, ICMP), initiate a NIDS, and instruct a filtering device such as a firewall or router to dynamically alter its Access Control List to preclude further communications with the attacker, either indefinitely or for a specified period.

■■ In the case of a disallowed system call or application-specific behavior, initiate the HIDS agent to block the transaction.

■■ With TCP resets, often the IDS will send a TCP packet with the FIN flag set in the TCP header to both the attacker and the attacked host to gracefully reset the connection from both host’s perspective. By resetting the attacker, this discourages future attacks (if they keep getting resets). By resetting the attacked host, this frees up system resources that may have been allocated because of the attack.

■■ With system calls, if a process that does not normally need to access the web server’s data tries to access the data, the HIDS agent can disallow this access.

Active IPS Response Pitfalls Include:

■■ Cutting off legitimate traffic due to false positives: Entertain the notion that a signature has been written that is too generic in nature. This means that it sometimes fires because of exploit traffic and is a true positive but sometimes fires because of innocent traffic and is a false positive. If the signature is configured to send TCP resets to an offending address and does so in a false-positive situation, the IDS may be cutting off legitimate traffic.

■■ Self-induced denial of service: If an attacker decided to spoof the IP address of a business partner and sends attacks with the partner’s IP address and the organization’s IDS reacted by dynamically modifying the edge router configuration, it would cut off communications with the business partner.

Take note that active response mechanisms should be used carefully and be limited to the types of actions listed above. Some organizations take it upon themselves to implement systems that actively counter attack systems they believe have attacked them as a response. This is highly discouraged and may result in legal issues for the organization. It is irresponsible to counter attack any system for any reason.

Attackers
Attackers are threats generally thought of as people who perform overt and covert intrusions or attacks on systems, which are often motivated by a combination of motive, means, and opportunity.